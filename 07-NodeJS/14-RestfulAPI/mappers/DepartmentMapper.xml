<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="DepartmentMapper">
    <!--단일행 조회를 위한 기능 정의-->
    <select id="selectItem">
        select deptno, dname, loc from department where deptno=#{deptno};
    </select>
    <!-- 다중행 조회를 위한 기능 정의-->
    <select id='selectList'>
        select deptno, dname, loc from department
        <where>
            <if test="dname != null and dname != ''">
                dname like concat('%', #{dname}, '%')
            </if>
            <if test="loc != null and loc != ''">
                or loc like concat('%', #{loc}, '%')
            </if>
        </where>
        order by deptno desc
        <!--페이지 구현을 위한 LIMIT절 추가-->
        <if test="listCount > 0">
            LIMIT ${offset}, ${listCount}
        </if>
    </select>
    <!--데이터 저장을 위한 기능 정의-->
    <insert id="insertItem">
        insert into department (dname, loc) values (#{dname}, #{loc});
    </insert>
    <!--데이터 삭제를 위한 기능 정의-->
    <delete id="deleteItem">
        delete from department where deptno= #{deptno};
    </delete>
    <!--데이터 갱신을 위한 기능 정의-->
    <update id="updateItem">
        update department set dname= #{dname}, loc= #{loc} where deptno= #{deptno};
    </update>
    <!--데이터 수 조회하기-->
    <select id="selectCountAll">
        select count(*) as cnt from department
        <where>
            <if test="dname != null and dname != ''">
                dname like concat('%', #{dname}, '%')
            </if>
            <if test="loc != null and loc != ''">
            or loc like concat ('%', #{loc}, '%'')
            </if>
        </where>
    </select>
</mapper>